# 背景・目的
AIの登場により、チェック・レビュー領域も効率化が進んでいる。
しかし現状はChatGPTのようなチャット型アプリにて、対象と観点を与え、チャットの応答としてレビューの結果を得る方式がメインである。
そこで本プロジェクトでは様々なチェック対象（ドキュメント、プログラム、...）を簡単に・効率的にレビューすることができるAIレビュー専用のプラットフォームを構築する。
アプリの名称はAIKATAとする

# 対照範囲
チェック・レビューに関する以下の工程を対象とする
- チェックリスト作成
- レビュー実行
- レビュー結果に関する質疑応答

# 前提
## ユーザの利用に関して
- 複数ユーザで利用
  - プロジェクトやレビュースペースの仕組みを用意
- ユーザ属性は以下
  - 氏名
  - 社員ID
## チェック対象について
- チェック対象は複数のファイルの組み合わせで構成される
- 基本的にはドキュメントとして取り扱う
- ただし、ドキュメントでない場合にも対応できるように、プラグイン機能（機能フック）を構築する
  - チェック対象の処理方法をドキュメント用のテキスト抽出から変更できる
## 本プロジェクトの進め方
- アジャイルで実施
- MVP完了時点で初期版をリリースできるように進める
  - その後は1つのPBI完了ごとに独立してリリースできるように進める
## アプリの利用イメージ
1. アプリにログイン（外部認証サーバ経由）
2. 自身のプロジェクトに移動（存在しない場合は、新規作成）
3. チェックリストを作成
4. レビュー実行

# 制約
## AIのAPIに関する制約（社内のAIチームから発行されるAPIを利用するため独自の制約が存在）
- 厳しい流量制限があるため、システム用に一つのAPIキーを使い回すことは現状難しい
  - よってプロジェクトごとにキーを発行し、アプリを利用する際に指定する必要がある
  - ただし、将来的には本制限が解消される可能性もある（APIキーの取り扱いを柔軟に変更できるようにシステム設計する必要がある）

# 機能要件（PBI）
## プロジェクト登録機能
### ユーザストーリー
- ユーザがプロジェクトを作成、編集したり、特定プロジェクトに移動できるようにする
- なぜなら、チーム(プロジェクト)単位でレビューを運用できるようにするためだ
### 受け入れ基準
- プロジェクト名・説明・APIキー・ユーザを指定できる
  - 説明・APIキーは任意
  - ユーザはデフォルトで自身が選択済み
  - ユーザ指定の際は(大量ユーザが存在することを想定して)検索をすることができる
- プロジェクトに所属するユーザは当該プロジェクト名・説明・APIキー・ユーザを編集できる
- プロジェクトに所属するユーザは当該プロジェクトを削除できる
- ユーザは自身が所属するプロジェクトを選択して、プロジェクト内のレビュースペースを参照できる
  - 自身が所属するプロジェクト一覧を最終更新時刻の降順で確認できる
  - 切り替えの際は（大量プロジェクトが存在することを想定して）プロジェクトを検索をすることができる

## レビュースペース管理機能
### ユーザストーリー
- ユーザがプロジェクト内で、レビュースペースを作成、編集でき、自由に特定のスペースに移動できる
- なぜなら同一プロジェクト内で、複数のチェックリストを運用できるようにするためだ
  - 例えば、〇〇システム開発プロジェクトがあったとして、開発工程ごとにチェックリストを用意しているはず
    - この場合は開発工程ごとにレビュースペースを作成することができる
### 受け入れ基準
- スペース名、説明、レビュー時ユーザ設定項目の既定値を指定できる
  - 説明は任意
- スペース名、説明、レビュー時ユーザ設定項目の既定値を編集できる
- 任意のスペースに切り替えることができる
- プロジェクト内のスペース一覧を最終更新時刻の降順で確認できる
- プロジェクトに所属するユーザは、レビュースペースの削除ができる

## チェックリスト登録・編集
### ユーザストーリー
- ユーザは下記の方法でレビュースペース内にチェックリストを登録できる。レビュー実行の際はチェックするための観点が必要だからだ。
  - ファイル抽出(チェックリストファイルから機械的に抽出)
  - AIチェックリスト生成(ドキュメントからユーザが指定した要件に沿ってAIがチェックリストを生成する)
- また、登録したチェックリストを確認し、追加、編集、削除ができる。特にAIがチェックリストを生成した場合は人手による最終的な確認が必要だからだ。
### 受け入れ基準
- ユーザがチェックリストファイルをアップロードし、そのファイルからチェックリストを抽出してレビュースペースに登録できる
  - ファイルはcsv,xls,xlsx形式を想定
  - 一列目に記載されている項目を全てチェックリストとして抽出する
- 一般的なドキュメントから、ユーザが指定した要件に従ってチェックリストをAIが作成して、レビュースペースに登録できる
  - ドキュメントは複数ファイルを選択可能（本紙・別紙構成のようなドキュメントにも対応できるようにするため）
- レビュースペースに登録済みのチェックリストに対して、追加、編集、削除ができる

## レビュー実行
### ユーザストーリー
- ユーザはレビュースペースに登録済みのチェックリストに対して、チェック対象をアップロードしてレビューを実行できる
### 受け入れ基準
- ユーザがチェック対象をアップロードし、そのチェック対象に対してAIがレビューを実行できる
  - チェックリストとそれぞれのチェック項目に紐づくレビュー結果をわかりやすく、表形式で確認できる
  - レビュー時ユーザ設定項目が指定可能であること
    - レビュースペース内に既にレビュー実行済みのチェック対象があれば、その際のレビュー時ユーザ設定項目がデフォルト値となること
- 一つのレビュースペースで複数のチェック対象のレビューができること

## レビューリトライ
### ユーザストーリー
- ユーザはレビュースペースで管理する初回レビュー実施済みのチェック対象についてはレビューのリトライのみが選択可能になる
- 初回レビュー時に全てのチェック項目に対してレビューが成功するとは限らないからだ
### 受け入れ基準
- 初回レビュー実施済みのレビュー対象についてはレビューのリトライのみが選択可能になっている
  - 全てのチェック項目に対してレビュー結果が紐づいてない場合は初回レビューと判断する
  - リトライのオプション
    - チェック項目のみ
    - 全てのチェック項目

## csv出力機能
### ユーザストーリー
- ユーザはチェックリストやレビュー結果をcsvで出力することができる
- 出力結果を二次利用したり、出力したチェックリストを別のレビュースペースで読み込ませるということができるからだ
### 受け入れ基準
- レビュースペースごとに、登録されているチェックリストとレビュー結果をそれぞれcsvファイルに出力することができる
- 出力ファイルをそのままチェックリスト登録のファイル抽出機能に適用してチェックリストを抽出することができる

## レビュー結果に関する質疑応答機能
### ユーザストーリー
- ユーザは特定のレビュー結果に対してAIに質問することができる
- レビュー対象の改善時に役立つからだ

--- ここまでMVP

## プラグイン機能（機能フック）
### ユーザストーリー
- ユーザはプラグインをレビュースペースに適用して、レビュー実行時の内部処理をフックすることができる
- ドキュメント以外の形式のレビュー対象に対してもレビューが実行できるようにするためだ
### 受け入れ基準
- プラグインの形式は単一のjsファイル
- プラグインにはレビュー実行時のレビュー対象の追加処理内容を登録可能
- プロジェクトルート内にplugin_exampleというプラグイン用のサンプルプロジェクトが作成されている
  - tsupでバンドルして最終的に一つのjsファイルにまとめる

## リアルタイム通知機能
### ユーザストーリー
- ユーザは自身が所属するプロジェクトにて、AIチェックリスト生成やレビュー実行のような時間がかかる処理が完了した場合に、通知を受け取ることができる

## 管理者機能
### ユーザストーリー
- AIKATAの管理者ユーザは、以下の権限を与えられる
  - 全プロジェクトへのアクセス・編集権限
  - 管理者ページへのアクセス
    - 管理者ページで可能なこと
      - 全プロジェクトの確認
      - 全プロジェクト・レビュースペースの強制削除
      - 現在実行中のレビュー一覧の確認
        - レビューの強制停止
    - ユーザ通知文言設定
      - 複数のユーザ通知文言を設定できる
- AIKATAを管理しやすくするためだ
### 受け入れ基準
- 管理者画面で設定したユーザ通知文言がどの画面でも表示されている（削除不可）
  - 通知文言が長い場合はスクロールして確認できる
  - ユーザ通知文言が解除されたらどの画面でも通知の表示が削除されている

